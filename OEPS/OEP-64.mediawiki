<pre>
  OEP: 64
  Title: Governance Change Standard
  Author:
  Type: Standard
  Status: Accepted
  Created: 2018-07-03
</pre>

==Abstract==

The OEP-64 proposal is a standard interface for the '''Governance Change Standard'''. There are three parties involved in the contract- '''SuperAdmin''', '''Admin''' and the '''Users'''.
SuperAdmin has the authority to assign administrator privileges.
Admin has the right to create topics and set the users who can vote for a topic.
Users are topic voters from the Mortgage node address.


==Motivation==

'''Governance Change Standard''' interace allows the community to update the governace strategy of Ontology blockchain in order to adapt to new developments.

==Specification==

===Methods===

====init====

<pre>
def init()
</pre>

'''SuperAdmin''' can invoke this method to initialize the contract.

====setAdmin====

<pre>
def setAdmin(admins)
</pre>

'''SuperAdmin''' can invoke this method to assign admin privileges. The admin can then invoke the <code>createTopic</code>method to create a new topic.
The parameter <code>admins</code> should be an array that contains 20-byte addresses.

====listAdmins====

<pre>
def listAdmins()
</pre>

Returns the address array that contains all the admins.

====createTopic====

<pre>
def createTopic(admin, topic, startTime, endTime, voters)
</pre>

An admin can invoke this method to create a new topic.
The parameters are of the following type:

{| class = "wikitable"
! style = "text-align:center;"| Parameter
! Type
|-
| admin
| 20 byte address
|-
| topic
| string
|-
| startTime
| UNIX timestamp
|-
| endTime
| UNIX timestamp
|-
| voters
| 2D array that contains all the <code>voters</code> and their respective <code>voter_weight</code>.
|}

====setVoterForTopic====

<pre>
def setVoterForTopic(hash, voters)
</pre>

A topic creator can invoke this method to assign the voters eligible to vote fora  topic.

{| class = "wikitable"
! style = "text-align:center;" | Parameter
! Type
|-
| hash
| 32-byte hash value
|-
| voters
| 2D array that contains all the <code>voters</code> and their respective <code>voter_weight</code>.
|}

Example: <code>[['AbtTQJYKfQxq4UdygDsbLVjE8uRrJ2H3tP', 100000], ['AbtTQJYKfQxq4UdygDsbLVjE8uRrJ2H3tP',100000]]</code>

====listTopics====

<pre>
def listTopics()
</pre>

Returns all the topic hashes.

====getTopic====

<pre>
def getTopic(hash)

</pre>

Returns the corresponding [topicTitle,topicDetail], for example, ['Update the Governance Strategy, mortgage unlocking cycle changed from 2 months to 1 month','Update the Governance Strategy, mortgage unlocking cycle changed from 2 months to 1 month'].
The parameter <code>hash</code> should be a 32-byte hash that corresponds to a topic.

====getTopicInfo====

<pre>
def getTopicInfo(hash)
</pre>

Returns the <code>topicInfo</code> which includes 'admin, topicTitle, topicDetail, voter address, startTime, endTime, approve amount, reject amount, status, topicHash'.

The parameter <code>hash</code> should be the 32-byte hash of the topic name.

Response description:

* <code>admin</code>: Creator of the topic
* <code>topic_title</code>: Topic title
* <code>topic_detail</code>: Topic details
* <code>voter</code>: A 2D array containing the addresses and weight for all the authorized voters, for e.g., [['AbtTQJYKfQxq4UdygDsbLVjE8uRrJ2H3tP',100000],['Ac9JHT6gFh6zxpfv4Q7ZPLD4xLhzcpRTWt',100000]]
* <code>startTime</code>: Start time for voting on the topic
* <code>endTime</code>:End time for voting on the topic
* <code>approve amount</code>: Total number of voters that approve the topic, sum of the weights of approving voters
* <code>reject amount</code>: Total number of voters that reject the topic, sum of the weights of rejecting voters
* <code>status</code>: Status of the topic, <code>0</code> represents <code>cancelled</code>, <code>1</code> represents <code>normal</code>
* <code>topicHash</code>: Topic hash

====getVoters====

<pre>
def getVoters(hash)
</pre>

Return all the voters of a topic, each voter record consists of voter address and voter weight.

====voteTopic====

<pre>
def voteTopic(hash, voter, approveOrReject)
</pre>

Voters can invoke this method to approve or reject a topic.

The parameter <code>hash</code> is the topic hash.
The parameter <code>voter</code> is one of the voters set by an admin.
The parameter <code>approveOrReject</code> is a boolean value, true implies approve, false implies reject.


====getVotedInfo====

<pre>
def getVotedInfo(hash, voter)
</pre>

Voters can invoke this method to query own voted Info, approve or reject.

The parameter <code>hash</code> is the topic hash.
The parameter <code>voter</code> is one of the voters set by an admin.

Return value is 1 or 2, 1 means approve, 2 means reject, other means not voted

====getVotedAddress====

<pre>
def getVotedAddress(hash)
</pre>

Users can invoke this method to query all voted address and vote result of a topic.
The parameter <code>hash</code> is the topic hash.

Return value is array of all the address and vote result.

====getTopicInfoListByAdmin====

<pre>
def getTopicInfoListByAdmin(admin)
</pre>

Users can invoke this method to query all topicInfo of a admin.
The parameter <code>hash</code> is the topic hash.

Return value is array of topicInfo.


===Events===

====createTopic====

<pre>
CreateTopicEvent = RegisterAction("createTopic", "hash", "topic")
</pre>

The event must be triggered when topic are created.

====VoteTopicEvent====

<pre>
VoteTopicEvent = RegisterAction("voteTopic", "hash", "voter")
</pre>

The event must be triggered on any successful calls to <code>voteTopic</code>.

===Implementation===